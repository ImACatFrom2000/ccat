<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>ポケモンクイズ</title>
        <style>
            .correct { color: red;}
            .false {text-decoration: line-through;}
        </style>
    </head>
    <body>
        <header>
            <h1>ポケモンクイズ</h1>
        </header>
        <main>
            <div class="question">
                <p>以下の条件に当てはまるポケモンは何？</p>
                <p>タイプ：<span id="type"></span></p>
                <p>特性：<span id="ability"></span></p>
                <p>種族値：<span id="status"></span></p>
            </div>
            <div>
                <p>選択肢</p>
                <ul id="choices"></ul>
            </div>
            <p id="answer"></p>
        </main>
    </body>
    <script src="../dentaku/jquery-3.7.1.min.js"></script>
    <script>
        'use strict';

        $(document).ready(function(){
            $.getJSON('data.json')
                .done(function(pokemon) {
                    //選択肢を4つ作る
                    let copy = pokemon;
                    let choices = [];
                    let i;
                    for(i=0; i<4; i++){
                        const select = Math.floor(Math.random() * copy.length);
                        choices.push(copy[select]);
                        copy.splice(select, 1);
                    }
                    for(i=0; i<4; i++){
                        document.getElementById('choices').insertAdjacentHTML('beforeend', `<li>${choices[i].name}</li>`);
                    }

                    //選択肢のうち一つを正解にする
                    const correct = Math.floor(Math.random() * choices.length);
                    $(`#choices li:nth-child(${correct + 1})`).attr('id','correct')
                    
                    //正解のタイプ等を問題文に出力
                    $('#type').text(choices[correct].type);
                    $('#ability').text(choices[correct].ability);
                    $('#status').text(choices[correct].status);
                    
                    //選択肢をクリックしたら
                    $('#choices li').on('click', function(){
                        //正誤を出力
                        if($(this).attr('id') === 'correct'){
                            $('#answer').text('正解！')
                        } else {
                            $('#answer').text(`不正解`)
                        }
                        //選択肢の見た目を変える
                        for(i=0; i<4; i++){
                            if($(`#choices li:nth-child(${i+1})`).attr('id') === 'correct'){
                                $(`#choices li:nth-child(${i+1})`).addClass('correct');
                            } else {
                                $(`#choices li:nth-child(${i+1})`).addClass('false');
                            }
                        }
                    })
                })
                .fail(function(jqxhr, textStatus, error) {
                    // 失敗時：エラーハンドリング
                    var err = textStatus + ", " + error;
                    console.error('JSONファイルの読み込み中にエラーが発生しました:', err);
                })
        })
    </script>
</html>